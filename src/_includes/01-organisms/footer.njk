{# 
=========================
    FOOTER ORGANISM
      v1.0 - Thomas       
=========================
#}

{# Import des atoms n√©cessaires #}
{% from "03-atoms/vector.njk" import renderVector %}
{% from "03-atoms/typography.njk" import renderTypography %}
{% from "03-atoms/link.njk" import renderLink %}
{% from "03-atoms/icon.njk" import renderIcon %}

{% macro renderFooter(option) %}
  {# Check if datas is provided #}
  {% if not option.datas %}
    <span class="text-red-500">Error: No footer configuration provided</span>
  {% else %}
    {# Retrieve footer configuration #}
    {% set footersConfig = option.datas %}
    {% set footerName = option.name %}
    
    {# Find the specific footer by name #}
    {% set footerData = null %}
    {% for footer in footersConfig %}
      {% if footer.name == footerName %}
        {% set footerData = footer %}
      {% endif %}
    {% endfor %}

    {# Fallback if footer not found #}
    {% if not footerData %}
      <span class="text-red-500">Footer not found: {{ footerName }}</span>
    {% else %}
      {# Build CSS classes #}
      {% set variant = footerData.variant | default('thomas') %}
      {% set cssClasses = 'footer' %}
      
      {# Add any additional classes #}
      {% if option.class %}
        {% set cssClasses = cssClasses ~ ' ' ~ option.class %}
      {% endif %}
      
      {# Desktop Footer #}
      <footer class="{{ cssClasses }} footer-desktop">
        <div class="footer-container">
          {# Content Grid - 4 columns: Logo + 3 content columns #}
          <div class="footer-content">
            {# Brand Column with copyright at bottom #}
            <div class="footer-column">
              {{ renderVector({ 
                name: footerData.brand.desktop,
                datas: option.vectorDatas
              }) }}
              
              {# Copyright in first column #}
              <div class="footer-copyright">
                <span>¬© {{ footerData.copyright.year }} {{ footerData.copyright.name }}</span>
                <span class="footer-separator">‚Ä¢</span>
                {{ renderLink({ 
                  name: footerData.copyright.links[0],
                  datas: option.linkDatas
                }) }}
                <span class="footer-separator">‚Ä¢</span>
                <span>{{ footerData.copyright.additional_text }}</span>
              </div>
            </div>
            
            {# Navigation Column #}
            <div class="footer-column">
              <h3 class="footer-column-title">{{ footerData.navigation.title }}</h3>
              <nav class="footer-nav">
                {% for linkName in footerData.navigation.links %}
                  {{ renderLink({ 
                    name: linkName,
                    datas: option.linkDatas
                  }) }}
                {% endfor %}
              </nav>
            </div>
            
            {# Contact Column - Avec liens d'action #}
            <div class="footer-column">
              <h3 class="footer-column-title">{{ footerData.contact.title }}</h3>
              <div class="footer-contact">
                {% for item in footerData.contact.items %}
                  <div class="footer-contact-item">
                    {{ renderIcon({ 
                      name: item.icon,
                      datas: option.iconDatas
                    }) }}
                    {% if item.link %}
                      <a href="{{ item.link }}" class="footer-contact-text footer-contact-link">
                        {{ item.text | safe }}
                      </a>
                    {% else %}
                      <span class="footer-contact-text">{{ item.text | safe }}</span>
                    {% endif %}
                  </div>
                {% endfor %}
              </div>
            </div>
            
            {# Social Column #}
            <div class="footer-column">
              <h3 class="footer-column-title">{{ footerData.social.title }}</h3>
              <div class="footer-social">
                {% for social in footerData.social.links %}
                  {# R√©cup√©rer l'URL du lien depuis les donn√©es #}
                  {% set linkUrl = null %}
                  {% set linkTarget = null %}
                  {% set linkRel = null %}
                  {% for link in option.linkDatas %}
                    {% if link.name == social.link_name %}
                      {% set linkUrl = link.href %}
                      {% set linkTarget = link.target %}
                      {% set linkRel = link.rel %}
                    {% endif %}
                  {% endfor %}
                  
                  <div class="footer-social-item">
                    {% if linkUrl %}
                      <a href="{{ linkUrl }}" 
                         class="footer-social-link-mobile"
                         {% if linkTarget %}target="{{ linkTarget }}"{% endif %}
                         {% if linkRel %}rel="{{ linkRel }}"{% endif %}>
                        {{ renderIcon({ 
                          name: social.icon,
                          datas: option.iconDatas
                        }) }}
                      </a>
                    {% endif %}
                    {{ renderLink({ 
                      name: social.link_name,
                      datas: option.linkDatas
                    }) }}
                  </div>
                {% endfor %}
              </div>
            </div>
          </div>
        </div>
      </footer>
      
      {# Mobile Footer #}
      <footer class="{{ cssClasses }} footer-mobile">
        <div class="footer-container-mobile">
          {# Brand Section #}
          <div class="footer-brand-mobile">
            {{ renderVector({ 
              name: footerData.brand.mobile,
              datas: option.vectorDatas
            }) }}
          </div>
          
          {# Navigation Section #}
          <div class="footer-section-mobile">
            <h3 class="footer-section-title">{{ footerData.navigation.title }}</h3>
            <nav class="footer-nav-mobile">
              {% for linkName in footerData.navigation.links %}
                {{ renderLink({ 
                  name: linkName,
                  datas: option.linkDatas
                }) }}
              {% endfor %}
            </nav>
          </div>
          
          {# Contact Section - Avec liens d'action #}
          <div class="footer-section-mobile">
            <h3 class="footer-section-title">{{ footerData.contact.title }}</h3>
            <div class="footer-contact-mobile">
              {% for item in footerData.contact.items %}
                <div class="footer-contact-item-mobile">
                  {{ renderIcon({ 
                    name: item.icon,
                    datas: option.iconDatas
                  }) }}
                  {% if item.link %}
                    <a href="{{ item.link }}" class="footer-contact-text footer-contact-link">
                      {{ item.text | safe }}
                    </a>
                  {% else %}
                    <span class="footer-contact-text">{{ item.text | safe }}</span>
                  {% endif %}
                </div>
              {% endfor %}
            </div>
          </div>
          
          {# Social Section Mobile - Dynamique depuis JSON #}
          <div class="footer-section-mobile">
            <h3 class="footer-section-title">{{ footerData.social.title }}</h3>
            <div class="footer-social-mobile">
              {% for social in footerData.social.links %}
                {# R√©cup√©rer l'URL du lien depuis les donn√©es #}
                {% set linkUrl = null %}
                {% set linkTarget = null %}
                {% set linkRel = null %}
                {% for link in option.linkDatas %}
                  {% if link.name == social.link_name %}
                    {% set linkUrl = link.href %}
                    {% set linkTarget = link.target %}
                    {% set linkRel = link.rel %}
                  {% endif %}
                {% endfor %}
                
                {% if linkUrl %}
                  <a href="{{ linkUrl }}" 
                     class="footer-social-link-mobile"
                     {% if linkTarget %}target="{{ linkTarget }}"{% endif %}
                     {% if linkRel %}rel="{{ linkRel }}"{% endif %}>
                    {{ renderIcon({ 
                      name: social.icon,
                      datas: option.iconDatas
                    }) }}
                    <span class="sr-only">{{ social.link_name }}</span>
                  </a>
                {% endif %}
              {% endfor %}
            </div>
          </div>
          
          {# Copyright Section #}
          <div class="footer-copyright-mobile">
            <span>¬© {{ footerData.copyright.year }}</span>
            <span class="footer-separator">‚Ä¢</span>
            {{ renderLink({ 
              name: footerData.copyright.links[0],
              datas: option.linkDatas
            }) }}
            <span class="footer-separator">‚Ä¢</span>
            <span>{{ footerData.copyright.additional_text }}</span>
          </div>
        </div>
      </footer>
    {% endif %}
  {% endif %}
{% endmacro %}

{# 
============================
Summon HAT Components Wisely
============================

1. Import the macro at the top of your page
{% from "01-organisms/footer.njk" import renderFooter %}

2. Call the footer organism
{{ renderFooter({ 
    name: "thomas_footer",
    datas: organisms.footer.footers,
    vectorDatas: atoms.vector.vectors,
    linkDatas: atoms.link.links,
    iconDatas: atoms.icon.icons
}) }}

May your bugs be forever exiled to the shadow realm. üßô‚Äç‚ôÇÔ∏è‚ú®
#}